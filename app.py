import streamlit as st
import random
import requests
from datetime import datetime
import re

# ---------------------- STREAMLIT CONFIG ----------------------
st.set_page_config(page_title="üåæ Krishisaathi AI", page_icon="üå±", layout="centered")

# ---------------------- CUSTOM CSS ----------------------
st.markdown("""
<style>
    @import url('https://fonts.googleapis.com/css2?family=Saira:wght@400;600;700&display=swap');

    
    .main-header {
        background: transparent;
        padding: 10px 0;
        border-radius: 0;
        color: #2e7d32;
        text-align: left;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 20px;
    }
    .logo-container {
        max-width: 150px;
    }
    .header-text h1 {
        color: #4caf50;
        font-size: 2.5em;
        margin: 0;
        font-weight: 700;
        font-family: 'Saira', sans-serif;
        letter-spacing: 2px;
    }
    .header-text p {
        color: #888;
        margin: 5px 0 0 0;
        font-size: 1.1em;
        font-family: 'Saira', sans-serif;
        font-weight: 400;
    }
    .stButton>button {
        background-color: #4caf50;
        color: white;
        border-radius: 8px;
        border: none;
        padding: 10px 24px;
        font-weight: bold;
    }
    .stButton>button:hover {
        background-color: #45a049;
    }
    .disease-section {
        background-color: #f0f8f0;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid #4caf50;
        margin: 10px 0;
    }
</style>
""", unsafe_allow_html=True)

# Display logo and header in same line
st.markdown('<div class="main-header">', unsafe_allow_html=True)

col1, col2 = st.columns([1, 4])
with col1:
    try:
        st.image("logo.png", use_container_width=True)
    except FileNotFoundError:
        st.warning("‚ö†Ô∏è")

with col2:
    st.markdown("""
    <div class="header-text">
        <h1>üåæ KRISHISAATHI AI CHATBOT</h1>
        <p>Your smart assistant for sustainable farming üöú</p>
    </div>
    """, unsafe_allow_html=True)

st.markdown('</div>', unsafe_allow_html=True)

# ---------------------- INITIALIZE SESSION ----------------------
if "messages" not in st.session_state:
    st.session_state.messages = []
if "user_location" not in st.session_state:
    st.session_state.user_location = None
if "expect_image" not in st.session_state:
    st.session_state.expect_image = False

# ---------------------- WEATHER FUNCTION ----------------------
def get_weather(city):
    """Fetches real-time weather data"""
    API_KEY = "bc072ed23f5983aac7f32d666efe49af"
    BASE_URL = "http://api.openweathermap.org/data/2.5/weather"
    
    try:
        params = {"q": city, "appid": API_KEY, "units": "metric"}
        response = requests.get(BASE_URL, params=params, timeout=5)
        
        if response.status_code == 200:
            data = response.json()
            return {
                "city": data["name"],
                "temperature": data["main"]["temp"],
                "feels_like": data["main"]["feels_like"],
                "humidity": data["main"]["humidity"],
                "description": data["weather"][0]["description"],
                "wind_speed": data["wind"]["speed"]
            }
    except:
        pass
    return None

# ---------------------- DISEASE DETECTION (PLACEHOLDER) ----------------------
def ai_predict_disease(image_file):
    """
    Placeholder for future ML model.
    Replace this with model.predict(image) after training.
    """
    diseases = {
        "Tomato - Late Blight": {
            "symptoms": "Dark brown spots on leaves, white mold on undersides",
            "treatment": "Remove infected leaves, apply copper-based fungicide, improve air circulation",
            "prevention": "Avoid overhead watering, use resistant varieties"
        },
        "Potato - Early Blight": {
            "symptoms": "Circular brown spots with concentric rings on older leaves",
            "treatment": "Apply fungicide (Mancozeb), remove infected leaves",
            "prevention": "Crop rotation, proper spacing, mulching"
        },
        "Apple - Cedar Apple Rust": {
            "symptoms": "Orange spots on leaves, premature leaf drop",
            "treatment": "Apply fungicide in spring, remove infected leaves",
            "prevention": "Remove nearby cedar trees, use resistant varieties"
        },
        "Rice - Brown Spot": {
            "symptoms": "Oval brown spots on leaves and grains",
            "treatment": "Apply Tricyclazole or Mancozeb, ensure proper nutrition",
            "prevention": "Use disease-free seeds, balanced fertilizer"
        },
        "Wheat - Leaf Rust": {
            "symptoms": "Orange-red pustules on leaves",
            "treatment": "Apply Propiconazole fungicide at first sign",
            "prevention": "Use resistant varieties, early sowing"
        },
        "Healthy Crop": {
            "symptoms": "No disease detected",
            "treatment": "Continue regular care and monitoring",
            "prevention": "Maintain good agricultural practices"
        }
    }
    
    # Random selection for demo
    disease_name = random.choice(list(diseases.keys()))
    disease_info = diseases[disease_name]
    
    return {
        "name": disease_name,
        "confidence": random.randint(75, 98),
        **disease_info
    }

# ---------------------- PRODUCE PRICE FUNCTION ----------------------
def get_produce_prices(state="all"):
    """Weekly Updated Market Prices - 100+ Cities Pan India Coverage
    Last Updated: October 12, 2025"""
    
    sample_prices = {
        # ========== NORTH INDIA ==========
        # Delhi NCR Updated Dataset (October 2025)

    "Delhi": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ35-55", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-45", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ20-35", "unit": "per bunch", "trend": "‚Üë"},
        "Green Peas": {"price": "‚Çπ70-100", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-75", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ25-40", "unit": "per kg", "trend": "‚Üì"},
        "Pumpkin": {"price": "‚Çπ18-30", "unit": "per kg", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ45-60", "unit": "per dozen", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ120-160", "unit": "per kg", "trend": "‚Üë"}
    },

    "Noida": {
        "Tomato": {"price": "‚Çπ23-37", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-50", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ52-78", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ72-98", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ48-62", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ90-125", "unit": "per kg", "trend": "‚Üí"}
    },

    "Gurgaon": {
        "Tomato": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-26", "unit": "per kg", "trend": "‚Üí"},
        "Capsicum": {"price": "‚Çπ55-80", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ36-52", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ22-36", "unit": "per bunch", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ46-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"}
    },

    "Faridabad": {
        "Tomato": {"price": "‚Çπ23-37", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-52", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ29-43", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ31-46", "unit": "per kg", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üí"},
        "Capsicum": {"price": "‚Çπ52-74", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ45-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ88-122", "unit": "per kg", "trend": "‚Üí"}
    },

    "Ghaziabad": {
        "Tomato": {"price": "‚Çπ23-37", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ29-42", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-50", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ20-34", "unit": "per bunch", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-72", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ70-95", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ46-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-118", "unit": "per kg", "trend": "‚Üí"}
    },

        # Punjab Updated Dataset (October 2025)

    "Chandigarh": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-50", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ18-30", "unit": "per bunch", "trend": "‚Üë"},
        "Green Peas": {"price": "‚Çπ68-95", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-72", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ20-32", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ16-28", "unit": "per kg", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ80-115", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ110-150", "unit": "per kg", "trend": "‚Üë"}
    },

    "Ludhiana": {
        "Tomato": {"price": "‚Çπ18-32", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ12-22", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ13-21", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ7-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-48", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ46-70", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ18-28", "unit": "per bunch", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ22-34", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ65-92", "unit": "per kg", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ18-30", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ16-27", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-55", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"}
    },

    "Amritsar": {
        "Tomato": {"price": "‚Çπ19-33", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ17-25", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-50", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-39", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ20-32", "unit": "per bunch", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ23-36", "unit": "per kg", "trend": "‚Üì"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ20-32", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ17-28", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ68-96", "unit": "per kg", "trend": "‚Üë"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"}
    },

    "Jalandhar": {
        "Tomato": {"price": "‚Çπ19-33", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ17-25", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ31-48", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ29-43", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-72", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ19-30", "unit": "per bunch", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ66-94", "unit": "per kg", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ19-31", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ41-57", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"}
    },

    "Patiala": {
        "Tomato": {"price": "‚Çπ19-33", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ17-25", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ31-48", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ29-43", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ47-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Spinach": {"price": "‚Çπ19-30", "unit": "per bunch", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ19-31", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ17-28", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ68-95", "unit": "per kg", "trend": "‚Üë"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"}
    }
,

        
        # Haryana (October 2025)

    "Gurugram": {
        "Tomato": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-27", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-39", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-34", "unit": "per kg", "trend": "‚Üì"},
        "Banana": {"price": "‚Çπ44-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"}
    },
    "Faridabad": {
        "Tomato": {"price": "‚Çπ23-37", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Carrot": {"price": "‚Çπ30-42", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"}
    },
    "Panipat": {
        "Tomato": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ80-115", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Rajasthan (October 2025)

    "Jaipur": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-27", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-46", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-33", "unit": "per kg", "trend": "‚Üì"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ86-120", "unit": "per kg", "trend": "‚Üí"}
    },
    "Jodhpur": {
        "Tomato": {"price": "‚Çπ23-37", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ110-150", "unit": "per kg", "trend": "‚Üë"}
    },
    "Udaipur": {
        "Tomato": {"price": "‚Çπ21-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-22", "unit": "per kg", "trend": "‚Üì"},
        "Carrot": {"price": "‚Çπ28-40", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-55", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Uttar Pradesh (October 2025)

    "Lucknow": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-52", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-72", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ20-32", "unit": "per bunch", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ44-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"}
    },
    "Kanpur": {
        "Tomato": {"price": "‚Çπ21-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ29-43", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"}
    },
    "Varanasi": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ20-33", "unit": "per bunch", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ52-74", "unit": "per kg", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Uttarakhand (October 2025)

    "Dehradun": {
        "Tomato": {"price": "‚Çπ24-40", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-28", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-50", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-72", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ32-46", "unit": "per kg", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ22-34", "unit": "per kg", "trend": "‚Üì"},
        "Banana": {"price": "‚Çπ44-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ90-130", "unit": "per kg", "trend": "‚Üë"},
        "Peas (Green)": {"price": "‚Çπ60-80", "unit": "per kg", "trend": "‚Üë"}
    },
    "Haridwar": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-11", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ88-122", "unit": "per kg", "trend": "‚Üë"}
    }
,
        
        # Himachal Pradesh (October 2025)

    "Shimla": {
        "Tomato": {"price": "‚Çπ25-40", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-13", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-28", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ100-140", "unit": "per kg", "trend": "‚Üë"},
        "Peas (Green)": {"price": "‚Çπ70-95", "unit": "per kg", "trend": "‚Üë"}
    },
    "Manali": {
        "Tomato": {"price": "‚Çπ26-42", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üì"},
        "Carrot": {"price": "‚Çπ32-46", "unit": "per kg", "trend": "‚Üë"},
        "Apple": {"price": "‚Çπ110-150", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ44-60", "unit": "per dozen", "trend": "‚Üí"}
    }

,
        
        # ========== WEST INDIA ==========
        # Maharashtra Updated Dataset (October 2025)

    "Mumbai": {
        "Tomato": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ18-28", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ17-26", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ20-28", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ35-55", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ34-50", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ52-78", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ22-34", "unit": "per bunch", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ18-30", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ70-95", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ48-65", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ90-130", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ120-165", "unit": "per kg", "trend": "‚Üë"},
        "Mango (Alphonso)": {"price": "‚Çπ150-200", "unit": "per kg", "trend": "‚Üë"}
    },

    "Pune": {
        "Tomato": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ17-27", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-27", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-52", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ27-41", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-76", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ20-32", "unit": "per bunch", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ68-94", "unit": "per kg", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ21-33", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ18-28", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ46-62", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ88-125", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ118-160", "unit": "per kg", "trend": "‚Üë"}
    },

    "Nagpur": {
        "Tomato": {"price": "‚Çπ23-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ17-26", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ33-50", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Spinach": {"price": "‚Çπ18-30", "unit": "per bunch", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ20-32", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ17-27", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ68-92", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ45-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ115-155", "unit": "per kg", "trend": "‚Üë"}
    },

    "Nashik": {
        "Tomato": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ17-25", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-39", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-50", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-72", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ21-33", "unit": "per kg", "trend": "‚Üì"},
        "Spinach": {"price": "‚Çπ18-30", "unit": "per bunch", "trend": "‚Üë"},
        "Green Peas": {"price": "‚Çπ68-90", "unit": "per kg", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ19-31", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ44-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ110-150", "unit": "per kg", "trend": "‚Üë"}
    },

    "Aurangabad": {
        "Tomato": {"price": "‚Çπ23-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ17-25", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ33-50", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Spinach": {"price": "‚Çπ18-30", "unit": "per bunch", "trend": "‚Üë"},
        "Bottle Gourd (Lauki)": {"price": "‚Çπ20-32", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ17-28", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ68-92", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ45-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ115-155", "unit": "per kg", "trend": "‚Üë"}
    }
,

        
       # Gujarat (October 2025)

    "Ahmedabad": {
        "Tomato": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ20-28", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ32-46", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-74", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ35-52", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ44-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ86-122", "unit": "per kg", "trend": "‚Üí"}
    },
    "Surat": {
        "Tomato": {"price": "‚Çπ23-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ25-40", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ70-95", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ46-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # ========== SOUTH INDIA ==========
        # Karnataka (October 2025)

    "Bengaluru": {
        "Tomato": {"price": "‚Çπ24-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ20-28", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ28-44", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ20-34", "unit": "per bunch", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-76", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"}
    },
    "Mysuru": {
        "Tomato": {"price": "‚Çπ23-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ27-40", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ33-48", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
       # Tamil Nadu (October 2025)

    "Chennai": {
        "Tomato": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-28", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-40", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-50", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ22-34", "unit": "per bunch", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-74", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ38-52", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üí"}
    },
    "Coimbatore": {
        "Tomato": {"price": "‚Çπ23-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ27-39", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Telangana (October 2025)

    "Hyderabad": {
        "Tomato": {"price": "‚Çπ22-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-28", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-52", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ52-76", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ68-92", "unit": "per kg", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Spinach": {"price": "‚Çπ22-34", "unit": "per bunch", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ110-150", "unit": "per kg", "trend": "‚Üë"}
    },
    "Warangal": {
        "Tomato": {"price": "‚Çπ21-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-50", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ28-44", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-116", "unit": "per kg", "trend": "‚Üí"}
    }
,
# Telangana (October 2025)

    "Hyderabad": {
        "Tomato": {"price": "‚Çπ22-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-28", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ34-52", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ52-76", "unit": "per kg", "trend": "‚Üí"},
        "Green Peas": {"price": "‚Çπ68-92", "unit": "per kg", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Spinach": {"price": "‚Çπ22-34", "unit": "per bunch", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"},
        "Pomegranate": {"price": "‚Çπ110-150", "unit": "per kg", "trend": "‚Üë"}
    },
    "Warangal": {
        "Tomato": {"price": "‚Çπ21-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-50", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ28-44", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-116", "unit": "per kg", "trend": "‚Üí"}
    }
,
       # Kerala (October 2025)

    "Kochi": {
        "Tomato": {"price": "‚Çπ25-40", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ17-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ10-14", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ22-32", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ36-52", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ34-50", "unit": "per kg", "trend": "‚Üë"},
        "Spinach": {"price": "‚Çπ24-36", "unit": "per bunch", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ46-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ88-124", "unit": "per kg", "trend": "‚Üí"},
        "Pineapple": {"price": "‚Çπ38-54", "unit": "per piece", "trend": "‚Üí"}
    },
    "Thiruvananthapuram": {
        "Tomato": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ10-13", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ44-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ86-122", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # ========== EAST INDIA ==========
        # West Bengal (October 2025)

    "Kolkata": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-22", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"},
        "Pumpkin": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üí"}
    },
    "Siliguri": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-120", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
       # Bihar (October 2025)

    "Patna": {
        "Tomato": {"price": "‚Çπ21-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ48-70", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"}
    },
    "Gaya": {
        "Tomato": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ29-44", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-120", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Jharkhand
        
    "Ranchi": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ46-68", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-34", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ60-80", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"},
        "Mango": {"price": "‚Çπ90-130", "unit": "per kg", "trend": "‚Üì"}
    },
    "Dhanbad": {
        "Tomato": {"price": "‚Çπ23-37", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-120", "unit": "per kg", "trend": "‚Üí"},
        "Pineapple": {"price": "‚Çπ40-56", "unit": "per piece", "trend": "‚Üí"}
    },
    "Jamshedpur": {
        "Tomato": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Apple": {"price": "‚Çπ85-122", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Odisha
        
    "Bhubaneswar": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-22", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-25", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-37", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-40", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ46-68", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ20-32", "unit": "per bunch", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ22-35", "unit": "per kg", "trend": "‚Üì"},
        "Banana": {"price": "‚Çπ40-55", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ80-115", "unit": "per kg", "trend": "‚Üí"},
        "Mango": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üì"}
    },
    "Cuttack": {
        "Tomato": {"price": "‚Çπ21-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ29-42", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"}
    },
    "Puri": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ42-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-118", "unit": "per kg", "trend": "‚Üí"},
        "Papaya": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Assam & Northeast

    "Guwahati": {
        "Tomato": {"price": "‚Çπ23-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ19-28", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ27-40", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-48", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ50-72", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ23-36", "unit": "per kg", "trend": "‚Üì"},
        "Green Peas": {"price": "‚Çπ65-85", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ44-58", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ86-122", "unit": "per kg", "trend": "‚Üí"},
        "Pineapple": {"price": "‚Çπ38-52", "unit": "per piece", "trend": "‚Üí"}
    },
    "Dibrugarh": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Carrot": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-120", "unit": "per kg", "trend": "‚Üí"},
        "Papaya": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üí"}
    },
    "Silchar": {
        "Tomato": {"price": "‚Çπ24-38", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ28-40", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ45-60", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ88-125", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # ========== CENTRAL INDIA ==========
        # Madhya Pradesh

    "Bhopal": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-22", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Capsicum": {"price": "‚Çπ44-68", "unit": "per kg", "trend": "‚Üí"},
        "Spinach": {"price": "‚Çπ18-30", "unit": "per bunch", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ38-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ80-115", "unit": "per kg", "trend": "‚Üí"},
        "Mango": {"price": "‚Çπ85-120", "unit": "per kg", "trend": "‚Üì"}
    },
    "Indore": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-11", "unit": "per kg", "trend": "‚Üí"},
        "Carrot": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-56", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ84-120", "unit": "per kg", "trend": "‚Üí"},
        "Papaya": {"price": "‚Çπ30-45", "unit": "per kg", "trend": "‚Üí"}
    },
    "Gwalior": {
        "Tomato": {"price": "‚Çπ21-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cauliflower": {"price": "‚Çπ19-27", "unit": "per kg", "trend": "‚Üí"},
        "Capsicum": {"price": "‚Çπ46-70", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-116", "unit": "per kg", "trend": "‚Üí"}
    }
,
        
        # Chhattisgarh

    "Raipur": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-22", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-10", "unit": "per kg", "trend": "‚Üí"},
        "Cauliflower": {"price": "‚Çπ18-26", "unit": "per kg", "trend": "‚Üí"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-38", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üë"},
        "Carrot": {"price": "‚Çπ28-42", "unit": "per kg", "trend": "‚Üë"},
        "Cucumber": {"price": "‚Çπ22-34", "unit": "per kg", "trend": "‚Üì"},
        "Banana": {"price": "‚Çπ38-52", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ80-114", "unit": "per kg", "trend": "‚Üí"}
    },
    "Bilaspur": {
        "Tomato": {"price": "‚Çπ21-35", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-23", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Carrot": {"price": "‚Çπ29-43", "unit": "per kg", "trend": "‚Üë"},
        "Brinjal (Eggplant)": {"price": "‚Çπ25-39", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-55", "unit": "per dozen", "trend": "‚Üí"},
        "Papaya": {"price": "‚Çπ30-44", "unit": "per kg", "trend": "‚Üí"}
    },
    "Durg": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ13-22", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Capsicum": {"price": "‚Çπ46-68", "unit": "per kg", "trend": "‚Üí"},
        "Cucumber": {"price": "‚Çπ22-34", "unit": "per kg", "trend": "‚Üì"},
        "Apple": {"price": "‚Çπ82-116", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"}
    }
,
        
        # ========== UNION TERRITORIES ==========
     "Chandigarh": {
        "Tomato": {"price": "‚Çπ20-34", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ14-22", "unit": "per kg", "trend": "‚Üì"},
        "Apple": {"price": "‚Çπ80-115", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ42-56", "unit": "per dozen", "trend": "‚Üí"},
        "Papaya": {"price": "‚Çπ30-46", "unit": "per kg", "trend": "‚Üí"}
    },
    "Puducherry": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ15-25", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ16-24", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ9-12", "unit": "per kg", "trend": "‚Üí"},
        "Lady Finger (Bhindi)": {"price": "‚Çπ32-46", "unit": "per kg", "trend": "‚Üë"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Mango": {"price": "‚Çπ85-118", "unit": "per kg", "trend": "‚Üì"}
    },
    "Jammu & Kashmir": {
        "Tomato": {"price": "‚Çπ26-40", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ16-26", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ17-25", "unit": "per kg", "trend": "‚Üì"},
        "Apple": {"price": "‚Çπ60-90", "unit": "per kg", "trend": "‚Üí"},
        "Apricot": {"price": "‚Çπ120-160", "unit": "per kg", "trend": "‚Üë"},
        "Cherry": {"price": "‚Çπ180-250", "unit": "per kg", "trend": "‚Üë"},
        "Walnut": {"price": "‚Çπ350-420", "unit": "per kg", "trend": "‚Üí"}
    },
    "Ladakh": {
        "Tomato": {"price": "‚Çπ32-50", "unit": "per kg", "trend": "‚Üí"},
        "Potato": {"price": "‚Çπ20-30", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ22-32", "unit": "per kg", "trend": "‚Üì"},
        "Apple": {"price": "‚Çπ90-120", "unit": "per kg", "trend": "‚Üí"},
        "Apricot": {"price": "‚Çπ130-180", "unit": "per kg", "trend": "‚Üë"}
    },
    "Lakshadweep": {
        "Coconut": {"price": "‚Çπ25-35", "unit": "per piece", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ45-60", "unit": "per dozen", "trend": "‚Üí"},
        "Papaya": {"price": "‚Çπ35-50", "unit": "per kg", "trend": "‚Üí"},
        "Breadfruit": {"price": "‚Çπ50-70", "unit": "per kg", "trend": "‚Üí"}
    },
    "Andaman & Nicobar Islands": {
        "Tomato": {"price": "‚Çπ26-42", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ18-28", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ20-30", "unit": "per kg", "trend": "‚Üì"},
        "Coconut": {"price": "‚Çπ30-45", "unit": "per piece", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ50-65", "unit": "per dozen", "trend": "‚Üí"},
        "Pineapple": {"price": "‚Çπ40-55", "unit": "per piece", "trend": "‚Üí"}
    },
    "Dadra and Nagar Haveli & Daman and Diu": {
        "Tomato": {"price": "‚Çπ22-36", "unit": "per kg", "trend": "‚Üì"},
        "Potato": {"price": "‚Çπ14-24", "unit": "per kg", "trend": "‚Üí"},
        "Onion": {"price": "‚Çπ15-23", "unit": "per kg", "trend": "‚Üì"},
        "Cabbage": {"price": "‚Çπ8-11", "unit": "per kg", "trend": "‚Üí"},
        "Banana": {"price": "‚Çπ40-54", "unit": "per dozen", "trend": "‚Üí"},
        "Apple": {"price": "‚Çπ82-118", "unit": "per kg", "trend": "‚Üí"}
    }
}
    
    if state.lower() == "all":
        return sample_prices
    else:
        matched_cities = {}
        search_term = state.lower()
        
        for city, prices in sample_prices.items():
            if search_term in city.lower():
                matched_cities[city] = prices
        
        return matched_cities if matched_cities else None

# ---------------------- EXTRACT CITY FROM MESSAGE ----------------------
def extract_city_from_message(message):
    """Extracts city name from user message"""
    message_lower = message.lower()
    
    patterns = [
        r"(?:in|at|for)\s+([a-zA-Z\s]+)",
        r"([a-zA-Z]+)\s+(?:price|weather|market)",
    ]
    
    for pattern in patterns:
        match = re.search(pattern, message_lower)
        if match:
            city = match.group(1).strip()
            city = re.sub(r'\b(today|tomorrow|now|current|latest|price|prices|weather)\b', '', city).strip()
            if city and len(city) > 2:
                return city
    return None

# ---------------------- FORMAT PRICE RESPONSE ----------------------
def format_price_response(prices, city_name=None):
    """Formats price data into readable response"""
    if not prices:
        return "‚ùå Sorry, no price data found. Try: Delhi, Mumbai, Bangalore, Chennai, Kolkata, or Hyderabad."
    
    response = "üí∞ **Current Market Prices:**\n\n"
    
    for city, produce_data in prices.items():
        if city_name and city_name.lower() not in city.lower():
            continue
            
        response += f"üìç **{city}**\n\n"
        
        for item, data in produce_data.items():
            response += f"‚Ä¢ **{item}**: {data['price']} {data['unit']} {data['trend']}\n"
        
        response += "\n"
    
    response += "\nüìä **Legend:** ‚Üë Rising | ‚Üí Stable | ‚Üì Falling\n"
    response += "üìÖ **Updated:** October 12, 2025\n"
    response += "üí° **Tip:** Prices are approximate retail rates."
    
    return response

# ---------------------- FARMING KNOWLEDGE BASE ----------------------
farming_tips = {
    "crops": {
        "wheat": "üåæ Wheat grows best in cool, moist climates (10‚Äì25¬∞C). Requires well-drained loamy or clay-loam soil with pH 6.0‚Äì7.0. Apply farmyard manure and nitrogen-rich fertilizers. Avoid waterlogging for healthy yield.",
        "rice": "üçö Rice needs flooded fields and warm temperatures (20‚Äì35¬∞C). Prefers clayey or loamy soil that retains water well. Requires consistent irrigation and high humidity. Use organic compost or green manure for better yield.",
        "tomato": "üçÖ Tomatoes need 6‚Äì8 hours of sunlight daily. Grow best in warm weather (20‚Äì30¬∞C) with well-drained loamy soil (pH 6.0‚Äì6.8). Add compost and potash-based fertilizer. Stake plants for better fruiting.",
        "potato": "ü•î Potatoes prefer cool weather (15‚Äì20¬∞C). Grow in loose, sandy or loamy soil (pH 5.0‚Äì6.0). Add compost and wood ash to improve yield. Avoid high humidity during tuber formation.",
        "maize": "üåΩ Maize needs warm climate (18‚Äì27¬∞C) and well-drained fertile soil (pH 5.5‚Äì7.0). Requires full sun and moderate rainfall. Apply nitrogen fertilizers and organic manure.",
        "sugarcane": "üç¨ Sugarcane thrives in tropical climate (20‚Äì35¬∞C) and rich loamy soil. Requires high water and sunlight. Organic compost and nitrogen fertilizer improve sucrose content.",
        "soybean": "üå± Soybean grows in warm climates (20‚Äì30¬∞C) with moderate rainfall. Requires well-drained loamy soil (pH 6.0‚Äì7.5). Use rhizobium inoculation to boost nitrogen fixation.",
        "banana": "üçå Banana prefers warm, humid climates (25‚Äì35¬∞C) and deep, rich loamy soil with good drainage. Requires plenty of organic manure and potassium fertilizer.",
        "mango": "ü•≠ Mango trees need tropical to subtropical climates with dry periods. Grows well in deep, well-drained loam or alluvial soil (pH 5.5‚Äì7.5). Apply compost annually.",
        "onion": "üßÖ Onions grow in cool weather (13‚Äì24¬∞C). Prefer loose sandy loam soil (pH 6.0‚Äì7.0). Add phosphorus and potash before bulb formation.",
        "cabbage": "ü•¨ Cabbage prefers cool climate (10‚Äì25¬∞C) and fertile, moist loamy soil (pH 6.0‚Äì7.5). Use organic manure and nitrogen fertilizer for compact heads.",
        "brinjal": "üçÜ Brinjal (eggplant) thrives in warm weather (21‚Äì30¬∞C) and fertile loamy soil. Add compost and potassium fertilizer. Avoid frost and waterlogging.",
        "cauliflower": "ü•¶ Cauliflower prefers cool, moist climate (15‚Äì25¬∞C). Needs rich, well-drained soil with pH 6.0‚Äì7.5. Apply compost and boron for firm heads.",
        "carrot": "ü•ï Carrots prefer cool weather (15‚Äì20¬∞C) and sandy loam soil free of stones (pH 6.0‚Äì6.8). Add compost before sowing for sweeter roots.",
        "spinach": "üåø Spinach grows best in cool weather (10‚Äì24¬∞C). Requires fertile, moist soil (pH 6.0‚Äì7.0). Add nitrogen-rich fertilizer for greener leaves.",
        "chili": "üå∂Ô∏è Chilies grow in warm climate (20‚Äì35¬∞C) with full sunlight. Loamy soil with good drainage and organic manure ensures healthy fruiting.",
        "papaya": "üçà Papaya grows in tropical and subtropical climates (25‚Äì35¬∞C). Needs light, well-drained soil. Add compost and potash fertilizer for sweeter fruits.",
        "apple": "üçé Apple grows in cool climates (5‚Äì24¬∞C). Prefers well-drained loamy soil with pH 6.0‚Äì7.0. Requires winter chilling and organic mulch for good fruit set.",
        "grapes": "üçá Grapes grow in warm, dry climates (15‚Äì35¬∞C) with deep, well-drained sandy loam soil. Require potassium and magnesium for good yield.",
        "pomegranate": "üçí Pomegranate grows in semi-arid regions (20‚Äì35¬∞C). Prefers well-drained loamy soil (pH 6.0‚Äì7.5). Add organic compost for better flowering.",
        "watermelon": "üçâ Watermelon needs hot, dry climate (25‚Äì35¬∞C) and sandy loam soil with good drainage. Requires potassium fertilizer and regular irrigation during fruiting.",
        "mustard": "üåº Mustard prefers cool climate (10‚Äì25¬∞C) and fertile loamy soil with pH 6.0‚Äì7.5. Apply nitrogen and phosphorus fertilizer for better oil yield.",
        "cotton": "üßµ Cotton grows in warm climates (21‚Äì30¬∞C). Requires well-drained black or alluvial soil. Add potash and nitrogen fertilizers for longer fibers."
    },
    "seasons": {
        "spring": "üå∏ Spring: Ideal for planting tomatoes, corn, beans, cucumbers, spinach, and peppers. Maintain regular irrigation and start pest control early.",
        "summer": "‚òÄÔ∏è Summer: Regular watering is crucial. Protect crops from heat stress. Best for okra, gourds, eggplants, and chilies. Mulching helps retain moisture.",
        "monsoon": "üåßÔ∏è Monsoon: Plant rice, maize, soybean, and cotton. Watch for fungal infections and ensure proper drainage to avoid root rot.",
        "fall": "üçÇ Fall: Perfect for planting garlic, onions, winter wheat, mustard, and leafy greens. Apply compost and prepare soil for winter crops.",
        "winter": "‚ùÑÔ∏è Winter: Grow carrots, cabbage, peas, cauliflower, and spinach. Protect plants from frost and plan crop rotation for next season."
    },
    "pests": {
        "aphids": "üêõ Aphids: Suck sap and spread viruses. Control with neem oil, ladybugs, or soap water spray. Avoid over-fertilization with nitrogen.",
        "caterpillars": "üêõ Caterpillars: Chew leaves and fruits. Hand-pick, use Bt spray, or introduce trichogramma wasps.",
        "whiteflies": "ü¶ü Whiteflies: Cause leaf yellowing. Use yellow sticky traps and neem oil. Avoid excess nitrogen fertilizers.",
        "fruitfly": "üçä Fruit Fly: Damages fruits like mango, guava, and papaya. Use pheromone traps or neem extract sprays.",
        "rootrot": "ü¶† Root Rot: Caused by waterlogging and fungi. Improve soil drainage, use Trichoderma, and avoid overwatering.",
        "general": "üõ°Ô∏è Prevention: Crop rotation, companion planting, clean fields, balanced fertilizer use, and biological pest control."
    }
}

# ---------------------- CHATBOT RESPONSE LOGIC ----------------------
def get_bot_response(user_message):
    """Generates intelligent responses"""
    message_lower = user_message.lower()
    
    # Disease detection trigger
    if any(word in message_lower for word in ["disease", "sick", "infected", "spot", "pest", "diagnose", "check crop"]):
        st.session_state.expect_image = True
        return """üî¨ **Crop Disease Detection**

üì∑ Please upload a clear photo of:
- Affected leaves or stems
- Close-up of spots/damage
- Well-lit image

I'll analyze it and provide:
‚úÖ Disease identification
‚úÖ Treatment recommendations
‚úÖ Prevention tips"""
    
    # Price queries
    if any(word in message_lower for word in ["price", "cost", "rate", "market", "mandi"]):
        city = extract_city_from_message(user_message)
        
        if city:
            prices = get_produce_prices(city)
            return format_price_response(prices, city)
        else:
            return """üí∞ **Market Prices Available!**

üåç **Major Cities Covered:**
‚Ä¢ Delhi, Mumbai, Bangalore
‚Ä¢ Chennai, Kolkata, Hyderabad
‚Ä¢ And 100+ more cities!

**üí¨ Ask me like:**
- "Show prices in Mumbai"
- "Tomato price in Bangalore"
- "Market rates in Delhi"

**üìç Type your city name!** üåæ"""
    
    # Weather queries
    if any(word in message_lower for word in ["weather", "temperature", "rain", "forecast"]):
        city = extract_city_from_message(user_message)
        
        if not city:
            if st.session_state.user_location:
                city = st.session_state.user_location
            else:
                return "üìç Please specify a location!\nExample: 'Weather in Delhi'"
        
        weather = get_weather(city)
        if weather:
            return f"""üå§Ô∏è **Weather in {weather['city']}:**
            
- Temperature: {weather['temperature']}¬∞C (feels like {weather['feels_like']}¬∞C)
- Conditions: {weather['description'].title()}
- Humidity: {weather['humidity']}%
- Wind: {weather['wind_speed']} m/s

**Advice:** {"Good for outdoor work! üåû" if weather['temperature'] > 15 else "Indoor tasks recommended. üß•"}"""
        else:
            return f"‚ùå Couldn't fetch weather for '{city}'. Check spelling or try another city."
    
    # Crop advice
    for crop, info in farming_tips["crops"].items():
        if crop in message_lower:
            return f"**{crop.title()} Guide:**\n\n{info}"
    
    # Pest control
    for pest, info in farming_tips["pests"].items():
        if pest in message_lower:
            return f"**Pest Control:**\n\n{info}"
    
    # Irrigation
    if "irrigation" in message_lower or "drip" in message_lower or "water" in message_lower:
        return """üíß **Irrigation Tips:**

- **Drip:** Most efficient, 30-50% water savings
- **Sprinkler:** Good for large areas
- **Timing:** Early morning or evening
- **Amount:** 1-2 inches per week"""
    
    # Fertilizer
    if "fertilizer" in message_lower or "fertiliser" in message_lower:
        return """üå± **Fertilizer Guide:**

- **NPK:** N for leaves, P for roots, K for health
- **Organic:** Compost, manure, bone meal
- **Timing:** Before planting and during growth
- **Application:** Follow soil test recommendations"""
    
    # Greeting
    if any(word in message_lower for word in ["hello", "hi", "hey", "namaste"]):
        return """üôè **Namaste! Welcome to Krishisaathi!**

I can help you with:
üå§Ô∏è Weather forecasts
üí∞ Market prices (100+ cities)
üåæ Crop cultivation tips
üî¨ Disease detection (upload photo)
üêõ Pest management
üíß Irrigation advice
üß™ Fertilizer recommendations

**What would you like to know?** üöú"""
    
    # Goodbye
    if any(word in message_lower for word in ["bye", "goodbye", "thanks", "thank you"]):
        return "üôè Dhanyavaad! Happy farming! üåæ Feel free to ask anytime."
    
    # Default
    return """üåæ **How can I help you today?**

Ask me about:
‚Ä¢ üî¨ Crop disease (upload photo)
‚Ä¢ üí∞ Market prices
‚Ä¢ üå§Ô∏è Weather updates
‚Ä¢ üå± Crop tips
‚Ä¢ üêõ Pest control
‚Ä¢ üíß Irrigation
‚Ä¢ üß™ Fertilizers

**Type your question!** üöú"""

# ---------------------- SIDEBAR ----------------------
with st.sidebar:
    # Logo in sidebar
    try:
        st.image("logo.png", use_container_width=True)
        st.markdown("---")
    except FileNotFoundError:
        pass
    
    st.header("‚ÑπÔ∏è About")
    st.write("""
    **Krishisaathi AI** helps with:
    - üî¨ Disease detection (AI)
    - üå§Ô∏è Weather updates
    - üí∞ Market prices (100+ cities)
    - üåæ Crop cultivation tips
    - üêõ Pest management
    - üíß Irrigation advice
    """)
    
    st.divider()
    
    st.header("üéØ Quick Actions")
    if st.button("üì∑ Disease Detection"):
        user_msg = "Check crop disease"
        st.session_state.messages.append({"role": "user", "content": user_msg})
        bot_response = get_bot_response(user_msg)
        st.session_state.messages.append({"role": "assistant", "content": bot_response})
        st.rerun()
    
    if st.button("üìç Delhi Prices"):
        user_msg = "Show prices in Delhi"
        st.session_state.messages.append({"role": "user", "content": user_msg})
        bot_response = get_bot_response(user_msg)
        st.session_state.messages.append({"role": "assistant", "content": bot_response})
        st.rerun()
        
    if st.button("üå§Ô∏è Mumbai Weather"):
        user_msg = "Weather in Mumbai"
        st.session_state.messages.append({"role": "user", "content": user_msg})
        bot_response = get_bot_response(user_msg)
        st.session_state.messages.append({"role": "assistant", "content": bot_response})
        st.rerun()
        
    if st.button("üåæ Crop Tips"):
        user_msg = "Tell me about wheat"
        st.session_state.messages.append({"role": "user", "content": user_msg})
        bot_response = get_bot_response(user_msg)
        st.session_state.messages.append({"role": "assistant", "content": bot_response})
        st.rerun()
    
    st.divider()
    
    if st.session_state.user_location:
        st.info(f"üìç Location: {st.session_state.user_location}")
    
    if st.button("üóëÔ∏è Clear Chat"):
        st.session_state.messages = []
        st.session_state.expect_image = False
        st.rerun()

# ---------------------- CHAT INTERFACE ----------------------
for message in st.session_state.messages:
    with st.chat_message(message["role"]):
        st.markdown(message["content"])

# ---------------------- IMAGE UPLOAD SECTION ----------------------
if st.session_state.expect_image:
    st.markdown('<div class="disease-section">', unsafe_allow_html=True)
    st.subheader("üì∏ Upload Crop Image for Disease Detection")
    
    uploaded_file = st.file_uploader(
        "Choose an image (JPG, PNG, JPEG)", 
        type=["jpg", "png", "jpeg"],
        help="Upload a clear photo of affected leaves or crops"
    )
    
    if uploaded_file:
        col1, col2 = st.columns([1, 1])
        
        with col1:
            st.image(uploaded_file, caption="Uploaded Crop Image", use_container_width=True)
        
        with col2:
            with st.spinner("üî¨ Analyzing image..."):
                # AI prediction
                prediction = ai_predict_disease(uploaded_file)
                
                st.success(f"‚úÖ **Detection Complete!**")
                st.metric("Disease Identified", prediction['name'])
                st.metric("Confidence", f"{prediction['confidence']}%")
        
        # Detailed results
        st.markdown("---")
        st.markdown("### üìã Detailed Analysis")
        
        tab1, tab2, tab3 = st.tabs(["üîç Symptoms", "üíä Treatment", "üõ°Ô∏è Prevention"])
        
        with tab1:
            st.write(f"**Symptoms:** {prediction['symptoms']}")
        
        with tab2:
            st.write(f"**Treatment:** {prediction['treatment']}")
        
        with tab3:
            st.write(f"**Prevention:** {prediction['prevention']}")
        
        # Reset button
        if st.button("üîÑ Analyze Another Image"):
            st.session_state.expect_image = True
            st.rerun()
        
        if st.button("‚úÖ Done"):
            st.session_state.expect_image = False
            
            # Add to chat history
            result_msg = f"""‚úÖ **Disease Detection Complete**

**Identified:** {prediction['name']} ({prediction['confidence']}% confidence)

**Symptoms:** {prediction['symptoms']}

**Treatment:** {prediction['treatment']}

**Prevention:** {prediction['prevention']}"""
            
            st.session_state.messages.append({"role": "assistant", "content": result_msg})
            st.rerun()
    
    st.markdown('</div>', unsafe_allow_html=True)

# ---------------------- CHAT INPUT ----------------------
if prompt := st.chat_input("Ask about farming..."):
    st.session_state.messages.append({"role": "user", "content": prompt})
    with st.chat_message("user"):
        st.markdown(prompt)
    
    with st.chat_message("assistant"):
        with st.spinner("üå± Thinking..."):
            response = get_bot_response(prompt)
            st.markdown(response)
    
    st.session_state.messages.append({"role": "assistant", "content": response})

# ---------------------- FOOTER ----------------------
st.divider()
st.markdown("""
<div style='text-align: center; color: #666;'>
    <p>üåæ <b>Krishisaathi AI</b> - Empowering Farmers with Technology</p>
    <p style='font-size: 0.9em;'>üí° AI Disease Detection | Weekly Updated Prices | Real-time Weather</p>
</div>
""", unsafe_allow_html=True)
